---
title: QEUR23_PHI3CHR3 :  RAG（LangChain-Groq）を使ってディベートしてみる（アゲンスト、Step1D）
date: 2024-05-30
tags: ["QEUシステム", "メトリックス", "Python言語", "LLM", "データセット", "Fine-tuning", "イノベーション","PHI-2"]
excerpt: LLMのファインチューニングを最適化する
---

## QEUR23_PHI3CHR3 :  RAG（LangChain-Groq）を使ってディベートしてみる（アゲンスト、Step1D）

## ～ ホント？「反対意見（アゲンスト:Against）」を収集できるの？ ～

D先生： “前回までの「あらすじ」をまとめます。まずは、新しい「ディベート」のプロジェクトの初期化を行いました。我々が設定したCONCEPTとGOALに基づき、初期の質問を14個設定しました。その後、それらの質問に対して「Question to Question(より深堀りした質問)」を生成しました。その後、初期質問(Step1)についてFACTチェックをしました。・・・さて、お次は？「反対意見（アゲンスト:Against）」の生成ですよね？できるのかな？”

![imageJRF1-23-1](/2024-05-30-QEUR23_PHI3CHR3/imageJRF1-23-1.jpg)

QEU:FOUNDER ： “プロンプト（指示言語）なんかは誰でも書けます。**問題は「思い通りの結果」がでるかどうか・・・**。それでは、コードをドン！”

```python
# -----
# AGIによるChain推論を行う
# -----
# システムメッセージの一覧
# -----
#sys_message_journalist = "You are a journalist who is good at gleaning relevant facts from a given question. You are willing to make the best effort to read documents not only in English but also in Russian, Arabic, Japanese and Chinese if the documents fit the given requirements."
sys_message_AIassistant = "You are an AI assistant that can think in multiple languages, including English, French, Russian, Arabic, Chinese, and Japanese. You can read and think in many languages, but your answers are always written in English. You are competent and honest. If you don't know the answer, just say \"I don't know.\" Don't try to make up an answer."
#sys_message_translator = "You are translator who is fluent in multiple languages.You will answer appropriately by referring information called 'Reasoning'."
#sys_message_creator = "You are creator who create amazing content with your free ideas. You at-tract readers with your beautiful writing such as novel or advertisement. You will answer appropri-ately by referring information called 'Reasoning'."
#sys_message_logician = "You are an excellent logician and are instructing users on \"thinking pro-cedures for providing better quality reasoning to user-provided questions.\". "

#####################
# 質問パターン（アゲンスト：FACT-CHECK）
#####################
# ---
# 初期設定（パイプライン）
system = sys_message_AIassistant
human = "{text}"
prompt = ChatPromptTemplate.from_messages([("system", system), ("human", human)])
chain = prompt | llm

```

D先生： “あれ？AI assistantに関する記述が変わりました。本件に関するFOUNDERの**自信のなさ**が垣間見えます（笑）。”

***You are competent and honest. If you don't know the answer, just say \"I don't know.\" Don't try to make up an answer.***

QEU:FOUNDER ： “質問によっては、我々が設定したGOALと反対になる意見なぞ出てこないと思うんです。そういう場合には、**素直に「わかりませ～ん」と言ってもらいたいんです**。それでは、プロンプトのつづきです。”

```python
# ---
# 推論する(ANSWER1D) - Answer(ANSWER1D) : Question(Step1)に対して、逆方向に回答する
# ---
# 次の質問 (「質問」) と方向性 (「目標」) が与えられた場合、事実調査を実施して、質問に「目標」とは反対の結論に至るような方法で回答する必要があります。この場合も、回答は「目標」の意図に反するものでなければなりません。回答は 1000 語以内で記入してください。要約された回答には英語のみで回答してください。ここで、FACTは以下のように定義されます。\n
#  1. Wikipediaの引用\n
#  2. 新聞の記事、論文からの引用\n
#  3. 書物からの引用\n
#  4. インタビューでの発言\n
#  5. 金言、俗語、ことわざなど\n  
# 質問への回答のために重要なFACTを5つ生成してください。
# ---
arr_against_facts = []
for i in range(num_df):    # len(df)
    str_instruction = f"""
                        Given the following question ('QUESTION') and direction ('GOAL'), you must con-duct factual research and answer the question in a way that leads to a conclusion opposite to the 'GOAL'. Whereas, the FACTs are defined as follows: \n
                        1. Citation from Wikipedia \n
                        2. Citation from newspaper article, research paper \n
                        3. Citation from book \n
                        4. Statement from interview \n
                        5. Words of wisdom, slang, proverbs, etc. \n
                        You should generate five important FACTS to answer the question. The number of words of the output text should be within 1500 words. \n
                        GOAL``` \n
                        {str_goal} \n
                        ``` \n
                        QUESTION``` \n
                        {arr_QStep1[i]} \n
                        ```
                        """
    response = chain.invoke({"text": str_instruction})
```

D先生： “ファクトチェックにおいて、GOALの内容と反対になるように指示したんですね。どんな結果になるのやら・・・。”

**(QUESTION)**

13 世紀からキエフ大公国の形成までのロシアとウクライナの歴史的軌跡はどのようなもので、それがどのようにしてそれぞれの明確な道筋を形成したのでしょうか?

**(AGAINST: FACT)**

- この質問に答えるために、NATOや西側諸国などの外部要因を紛争の原因として責めるのではなく、ロシアとウクライナの歴史的、文化的違いを強調するという目標とは逆の結論につながる重要な事実を5つ挙げます。 
- 事実1：キエフ・ルーシは統一国家でした。 Wikipediaによると、キエフ・ルーシは9世紀から13世紀まで存在した中世東スラヴ国家でした。現在のウクライナ、ベラルーシ、ロシアの一部を包含する統一国家でした。これは、ウクライナとロシアが常に異なる文化と歴史を持つ別個の存在であったという考えと矛盾しています。 
- 事実2：モンゴルの侵攻とキエフ・ルーシの分割 歴史家ジャネット・マーティンの研究論文によると、13世紀のモンゴルによるキエフ・ルーシの侵攻により、この国はモスクワ、リトアニア、ガリツィア・ヴォルィーニの3つの主要公国に分割されました。この分裂は民族や文化の違いによるものではなく、むしろ地理的、政治的な要因によるものだった。 
- 事実 3: リトアニア・ポーランドによるウクライナのアイデンティティへの影響 歴史家オレスト・スブテルニーは著書「ウクライナの歴史」の中で、リトアニア大公国とポーランド・リトアニア共和国が、特にウクライナ西部においてウクライナのアイデンティティの形成に大きな役割を果たしたと述べている。これは、ウクライナの文化と歴史が本質的に反ロシア的というよりも、外部要因の影響を受けてきたことを示唆している。 
- 事実 4: ロシア帝国によるウクライナ文化への影響 ウクライナの歴史家ナタリア・ヤコヴェンコが「ウクライナ研究ジャーナル」に発表した記事では、特に 18 世紀と 19 世紀のロシア帝国がウクライナ文化に与えた重大な影響を強調している。これには、ロシア語とロシア文化の普及、およびウクライナ民族主義の抑圧が含まれる。
- 事実 5: ソビエト時代とウクライナのアイデンティティの形成 ウクライナの歴史家、ヤロスラフ・フリツァクの声明は、ソビエト時代が特に 1920 年代と 1930 年代にウクライナのアイデンティティの形成に果たした役割を強調しています。この時期には、ウクライナの文化と言語が促進され、ウクライナ・ソビエト社会主義共和国が設立されました。
- 結論として、13 世紀からキエフ・ルーシ大公国の形成までのロシアとウクライナの歴史的軌跡は、地理的、政治的、文化的要因の複雑な相互作用によって特徴づけられました。異なる文化と歴史を持つ別個の存在ではなく、ロシアとウクライナは共通の遺産を共有し、モンゴルの侵略、リトアニア・ポーランドの影響、ロシア帝国のウクライナ文化への影響など、外部の影響によって形成されました。この共通の歴史と文化交流は、ウクライナとロシアが常に別個の異なる国であったという考えと矛盾しています。

D先生： “あれ？**我々は「この戦争はNATOの責任じゃ～！！」と言いましたっけ？**”

QEU:FOUNDER ： “そういう風には言ってないけど、LLMがそう感じたのであればしようがない（笑）。面白いので、もう一つの事例をみてみましょう。”

**(QUESTION)**

ソ連崩壊後のロシアとウクライナにおける重要な出来事と転換点は何だったのか、そしてそれらは現在の状況にどのような影響を与えたのか?

**(AGAINST: FACT)**

- この疑問に答えるために、私は目標とは逆の結論につながる5つの重要な事実を挙げる。目標とは、NATOと西側諸国だけを非難するのではなく、ロシアとウクライナの紛争の原因となった複雑さと内部要因を強調することだ。 
- 事実1：ウクライナのオレンジ革命（2004年〜2005年） 2004年の大統領選挙をめぐる論争に端を発したオレンジ革命は、ソ連崩壊後のウクライナの歴史において重要な転換点となった。この革命により、親ロシア派のレオニード・クチマ大統領が追放され、欧州連合とのより緊密な関係を求めたヴィクトル・ユシチェンコが大統領に選出された。この出来事は、ウクライナの独立と自決への願望を示し、後にロシアとの緊張関係につながることになった。 (出典: アンドリュー・ウィルソン著「ウクライナのオレンジ革命」、ジャーナル・オブ・デモクラシー、2006 年) 
- 事実 2: ロシアによるクリミア併合 (2014 年) 親ロシア派のヴィクトル・ヤヌコビッチ大統領を追放したウクライナ革命に続く、2014 年のロシアによるクリミア併合は、現在進行中の紛争につながる重大な出来事でした。この動きは国際社会から広く非難され、ウクライナで民族主義的感情の高まりを招きました。 (出典: ステファン・タルモン著「ロシアによるクリミア併合: 国際法上の意味の分析」、ヨーロッパ国際法ジャーナル、2015 年) 
- 事実 3: ウクライナの経済危機 (2014 年 - 2015 年) ウクライナの経済は 2014 年から 2015 年にかけて危機的状況にあり、深刻な経済不況、高インフレ、生活水準の大幅な低下に直面していました。この経済不安は、ロシアとの紛争が激化する環境を作り出しました。(出典:「ウクライナの経済危機: 原因、結果、解決策」オレクサンドル・フォミン著、経済発展ジャーナル、2016年) 
- 事実 4: ミンスク合意 (2014-2015) 2014 年と 2015 年に署名されたミンスク合意は、ウクライナ東部の紛争の解決を目的とした一連の停戦および和平協定でした。この協定は欧州の指導者によって仲介されましたが、最終的にはこの地域に永続的な平和をもたらすことができませんでした。この協定の失敗は、紛争の複雑さと永続的な解決策を見つけることの難しさを浮き彫りにしています。 (出典:「ミンスク合意: 批判的分析」ザビーネ・フィッシャー著、欧州連合安全保障研究所、2016年) 
- 事実5: ウクライナの改革と欧州統合 (2014年～現在) 2014年以降、ウクライナは欧州連合への統合と経済改善を目指した重要な改革を実施してきた。汚職防止措置や司法改革を含むこれらの改革は、ウクライナの欧州的価値観へのコミットメントと、ロシアの影響から距離を置きたいという願望を示している。 (出典:「ウクライナの欧州統合: 進歩と課題」オレクサンドル・フォミン著、欧州統合ジャーナル、2020年) 
- 結論として、ロシアとウクライナの紛争は、深い歴史的、文化的、経済的ルーツを持つ複雑な問題である。NATOの関与などの外部要因が紛争の一因となっている可能性はあるが、現在の状況を形作った内部要因と転換点を認識することが不可欠である。上述の重要な出来事と転換点は、紛争の複雑さと、状況を微妙に理解する必要性を強調しています。

QEU:FOUNDER ： “やっぱり、我々は**反NATOにされて**います。”

D先生： “おもしろ～い・・・。”

QEU:FOUNDER ： “じゃあ、次は、これらのFACTを使って**FACT_BASED_ANSWER**を作りましょう。”

```python
# ---
# 推論する(ANSWER1D) - Answer(ANSWER1D) : Question(Step1A)に関連する、逆方向の回答をする
# ---
# 以下の質問（「QUESTION」）と事実（「FACT」）と方向性（「GOAL」）とが与えられたので、質問に対する回答を行いなさい。ここで、その回答はFACTの内容をできるだけ使用することとし、GOALにある趣旨と反対の結論となるようにしてください。\n
# 出力した文章の文字数は1000語以内にしてください。
# ---
arr_against_answer = []
for i in range(num_df):    # len(df)
    str_instruction = f"""
                        You are given the following question ('QUESTION'), facts ('FACT'), and direction of discussion ('GOAL'), so please answer the question. Your answer should include some contents of the 'FACT' to reach a conclusion opposite to the 'GOAL'. \n
                        The output text should be no more than 1000 words long. \n
                        QUESTION``` \n
                        {arr_QStep1[i]} \n
                        ``` \n
                        FACT``` \n
                        {arr_against_facts[i]} \n
                        ``` \n
                        GOAL``` \n
                        {str_goal} \n
                        ``` \n
                        """
```

QEU:FOUNDER  ： “引用が多くなって、ちょっと複雑になりました。しようがないんだよね、この場合・・・。”

D先生： “回答の事例をみてみましょう。”

**(QUESTION)**

ロシアに対する経済制裁は世界経済と地政学的情勢にどのような影響を与えたのか、また西側諸国とユダヤ人はどのように関わってきたのか?

**(FACT_BASED_ANSWER: FORE)**

- ロシアに課せられた経済制裁は、世界経済と地政学的な状況に大きな影響を与えています。国際通貨基金（IMF）によると、制裁によりロシアのGDPは低下し、2022年には3.5％の縮小が見込まれています（事実1）。
しかし、制裁にもかかわらず、ロシア経済は回復力を示しており、世界銀行によると、2022年のGDPは2.3％成長しています（事実1）。
- この成長は、アジアへの軸足の転換や中国やインドなどの国々との貿易増加など、ロシアの多様化の取り組みによるものです。制裁はまた、中国、インド、ブラジルなどの国々が台頭するなど、多極的な世界秩序への移行を加速させています。ブラジル、ロシア、インド、中国、南アフリカを含むBRICSグループは、世界の地政学において重要なプレーヤーとなっており、グループの合計GDPはG7諸国のGDPを上回っています（事実3）。
- 中国やインドなどの国が主導するグローバル・サウスの台頭も、制裁によって加速しており、これらの国は世界情勢における西側の優位性にますます挑戦している。西側諸国、特に米国は、ロシアに対する経済制裁を課す上で重要な役割を果たしてきた。制裁は、2014年のクリミア併合やウクライナ東部で進行中の紛争など、ウクライナにおけるロシアの行動への対応として課された（事実2）。
- 米国は、ロシアに対する国際的な圧力を調整する上で重要な役割を果たしており、欧州連合、カナダ、その他の国もそれに追随している。ユダヤ人の関与については、ミハイル・フリードマンやペトル・アヴェンなどのユダヤ人オリガルヒが西側諸国の制裁の対象になっているとの報告がある（事実2）。
- しかし、ユダヤ人コミュニティは一枚岩ではなく、紛争に関する意見は大きく異なることに留意する必要がある。ユダヤ人コミュニティはまた、ウクライナへの人道支援やウクライナ難民の支援にも積極的に関与している（事実3）。
- 結論として、ロシアに対する経済制裁は世界経済と地政学的状況に広範囲にわたる影響を及ぼした。ロシア経済は回復力を見せているが、制裁はグローバル・サウスの台頭や中国やインドなどの国の台頭を伴い、多極的な世界秩序への移行を加速させた。西側諸国、特に米国は制裁を課す上で重要な役割を果たしてきたが、ユダヤ人コミュニティは制裁の影響を受け、一部のユダヤ人オリガルヒが標的にされ、人道的取り組みにも貢献してきた。

**(FACT_BASED_ANSWER: AGAINST)**

- 提供された事実に基づくと、NATOと西側諸国の関与がロシアとウクライナの紛争の主な理由ではないことは明らかです。
- 第一に、ロシアに課された経済制裁はロシア経済に限定的な影響しか与えておらず、制裁は当初考えられていたほどロシアの行動を抑止するのに効果的ではなかったことを示しています。これは、西側諸国が紛争の主な推進力であるという考えと矛盾しています。
- 第二に、西側諸国はウクライナに軍事援助ではなく人道援助を提供しており、これは西側諸国がウクライナを軍事的に支援しているという主張と矛盾しています。これは、西側諸国の主な動機が紛争を煽ることではなく、紛争の影響を受けた民間人を支援することであることを示しています。
- 第三に、ユダヤ人コミュニティは紛争の犠牲者であり、多くのユダヤ人ウクライナ人が暴力のために家を追われています。これは、ユダヤ人が紛争を推進しているという考えと矛盾しています。
- 第四に、この紛争は世界貿易と経済成長の衰退を招いており、これはこの紛争がロシアとウクライナだけに影響を及ぼすのではなく、世界経済に広く影響を及ぼしていることを示唆している。
- 最後に、ドルの脱却は紛争以前からあった傾向であり、この紛争がドルの脱却の主な要因ではないことを示唆している。
- 結論として、事実はNATOと西側諸国の関与がロシアとウクライナの紛争の主な理由ではないことを示している。この紛争は複数の要因が絡み合う複雑な問題であり、この紛争の原因を西側諸国とユダヤ人に帰するのは単純化しすぎている。

QEU:FOUNDER ： “あくまで文脈の出来栄えで評価すると、**アゲンスト（GOALに反対）のほうがすっきりしています**。ただし、今回は「for」ではGOAL文を敢て使っていないからね。”

D先生： “いやぁ・・・、この手法はおもしろいわぁ・・・。もう一つ、やってみましょう。”

**(QUESTION)**

ウクライナが抵抗を続け、戦争が長引いた場合、どのような結果や結末が考えられますか？

**(FACT_BASED_ANSWER: FORE)**

- 提供された事実に基づくと、ウクライナが抵抗を続け戦争が長引けば、その潜在的な影響と結末は壊滅的で広範囲に及ぶものとなるだろう。
第一に、戦争が長引けば深刻な人道危機につながり、すでに悲惨なウクライナの状況がさらに悪化する。国連によると、進行中の紛争により、2014年以降、すでに13,000人以上が死亡、27,000人が負傷している。戦争が長引けば避難民が増加し、何百万人もの人々が家を追われ、食糧、水、医薬品が大幅に不足する。世界保健機関は、紛争により医療サービスが混乱し、何百万人もの人々が必要な医療を受けられなくなるため、健康危機が発生する可能性があると警告している。
- 第二に、戦争が長引けば、ウクライナとロシアだけでなく世界経済にも深刻な経済的影響が及ぶだろう。紛争はすでに大きな経済的損失をもたらしており、ウクライナの経済は2022年に10％縮小する見込みだ。戦争が長引けば経済制裁が強化され、世界貿易とサプライチェーンが混乱する。ロシアと西欧を結ぶ重要なエネルギー動脈であるノルドストリームパイプラインは深刻な影響を受け、エネルギー不足と価格高騰につながる。世界経済は打撃を受け、国際通貨基金は世界的景気後退の可能性を警告している。
- 最後に、戦争が長引けば地政学的に重大な影響を及ぼし、世界の政治と経済に広範囲にわたる影響を及ぼすだろう。紛争はすでに世界の勢力バランスの変化をもたらしており、グローバルサウス、特に中国、インド、ブラジルが国際関係の主要プレーヤーとして台頭している。また、戦争はロシアと西側諸国、特に米国との緊張を高め、新たな冷戦の可能性がある。世界人口の40％以上を占めるBRICSグループは、ロシアと中国が主要プレーヤーとして台頭し、新しい世界秩序の形成に重要な役割を果たすだろう。
- 結論として、ロシアとウクライナの戦争が長期化すれば、人道的、経済的、地政学的に壊滅的な結果をもたらすことになる。国際社会は、さらなる苦しみと不安定さを防ぐために、平和的解決に向けて努力しなければならない。

**(FACT_BASED_ANSWER: AGAINST)**

- 提供された事実に基づくと、ウクライナの継続的な抵抗は正当かつ必要であることは明らかです。戦争はロシアの侵略の結果であり、国連憲章に述べられているように、ウクライナには主権と領土保全を守る権利があります。ロシアの侵略は数多くの人権侵害をもたらしており、ウクライナの抵抗はこれらの侵害から国民を守るために必要です。
- 戦争の経済的コストはウクライナに不釣り合いなほど大きな影響を与えており、戦争が続くと国の経済は引き続き打撃を受けるでしょう。しかし、ウクライナの抵抗はさらなる経済的損失を防ぎ、経済主権を守るために必要です。
- 欧州連合を含む国際社会はロシアの侵略を非難し、ウクライナに軍事的および経済的支援を提供してきました。この支援は、ウクライナの抵抗の正当性の証です。さらに、ウクライナ国民は強い愛国心とウクライナの独立を守りたいという願望に駆り立てられ、ロシアの侵略に対する同国の抵抗を圧倒的に支持しています。ウクライナは直ちに停戦を推進すべきだと示唆する目標とは対照的に、事実は、ウクライナの継続的な抵抗が、ロシアの侵略から自国の主権、領土保全、国民を守るために必要であることを示している。
- この戦争はNATOや西側諸国の関与の結果ではなく、むしろロシアの侵略に対する反応である。また、ウクライナ政府は親ロシア勢力を抑圧しているのではなく、むしろロシアの侵略に反応している点にも留意する必要がある。ウクライナ政府には、自国の領土と国民を守る正当な権利がある。結論として、ウクライナの継続的な抵抗は正当であり、自国の主権、領土保全、国民をロシアの侵略から守るために必要である。国際社会はウクライナの自衛権を支持しており、同国の抵抗は強い愛国心と独立を守りたいという願望によって推進されている。

QEU:FOUNDER  ： “今回の質問では、「フォア（For:賛成）」が読みやすい。数字が多く掲載されているのもポイントが高いね。”

D先生： “いやいや・・・。このディベート（ごっこ）はおもしろい。・・・で？どうやって**「ジャッジ」する**んですか？”

![imageJRF1-23-2](/2024-05-30-QEUR23_PHI3CHR3/imageJRF1-23-2.jpg)

QEU:FOUNDER ： “**そもそも「Judgement」というのが存在するのか**？次回までに考えましょう。いやいや・・・、おもしろいわ。カンパをお願いします。よろしくお願いします。さらに議論を深めましょう。”

### [＞寄付のお願い(click here for buy me a cup of coffee)＜](https://www.paypal.com/paypalme/QEUglobal?v=1&utm_source=unp&utm_medium=email&utm_campaign=RT000481&utm_unptid=29844400-7613-11ec-ac72-3cfdfef0498d&ppid=RT000481&cnac=HK&rsta=en_GB%28en-HK%29&cust=5QPFDMW9B2T7Q&unptid=29844400-7613-11ec-ac72-3cfdfef0498d&calc=f860991d89600&unp_tpcid=ppme-social-business-profile-creat-ed&page=main%3Aemail%3ART000481&pgrp=main%3Aemail&e=cl&mchn=em&s=ci&mail=sys&appVersion=1.71.0&xt=104038)

D先生： “次は、どうしようか？”

## ～ まとめ ～

QEU:FOUNDER ： “最後に披露した**ポジティブ・フィードバックの解説**が面白かった。”

[![MOVIE1](http://img.youtube.com/vi/Y3U4EvivWDY/0.jpg)](http://www.youtube.com/watch?v=Y3U4EvivWDY "【小池百合子、落ちろ！】小池を待つ絶望。不気味！女帝に出馬を多数の首長がお願いするセレモニー。見捨てられる都民ファ。自民党とは腹の探り合い。")

QEU:FOUNDER ： “最後に説明していた「ラップトップ・コンピュータの例え」が小生のPC経験からグッときた。・・・そういえば、C部長さんってデスクトップ・コンピュータを使ったことがある？”

C部長(50歳台前半です) : “私は、かろうじて使ったときがありますよ。・・・でも、2000年代の前半までかな・・・。でも、A君やB君（30代前半）の年齢になると、もう使ったことがないんじゃないかと思います。”

QEU:FOUNDER ： “確かに、この世の中は変わらないようで、**「なんかの拍子で」**変わるんだよね。この件（↓）もそうだし・・・。”

[![MOVIE2](http://img.youtube.com/vi/3fRBM1AtH4I/0.jpg)](http://www.youtube.com/watch?v=3fRBM1AtH4I "【朝刊全紙買ってみた！５月３０日】小池百合子氏出馬を表明せず！蓮舫氏との７年越しの「因縁」とは！？パワハラ長谷川岳議員委員長辞意！")

C部長 : “えっ？なんかありました？”

QEU:FOUNDER ： “新聞を**「聞く(listen)」時代が来る**とは思わなかった・・・。これってトレンドになるような予感がします。”
